(()=>{var e={};e.id=747,e.ids=[747],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},63477:e=>{"use strict";e.exports=require("querystring")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},44080:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>d,routeModule:()=>m,tree:()=>c}),s(86315),s(79870),s(35866);var r=s(23191),a=s(88716),i=s(37922),o=s.n(i),n=s(95231),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);s.d(t,l);let c=["",{children:["stories",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,86315)),"D:\\Apps\\Repositories\\personal\\thefortress\\app\\stories\\page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,79870)),"D:\\Apps\\Repositories\\personal\\thefortress\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],d=["D:\\Apps\\Repositories\\personal\\thefortress\\app\\stories\\page.js"],p="/stories/page",u={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/stories/page",pathname:"/stories",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},27619:(e,t,s)=>{Promise.resolve().then(s.bind(s,57437))},57437:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var r=s(10326),a=s(17577),i=s(77109);let o=()=>{let[e,t]=(0,a.useState)([]),[s,o]=(0,a.useState)(!0),[n,l]=(0,a.useState)(""),[c,d]=(0,a.useState)(!1),[p,u]=(0,a.useState)(""),[m,x]=(0,a.useState)(""),[h,g]=(0,a.useState)(null),[j,b]=(0,a.useState)(!1),{data:f,status:y}=(0,i.useSession)();(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/stories"),s=await e.json();e.ok?t(s.stories):l(s.error||"Failed to fetch stories")}catch(e){l("Failed to fetch stories"),console.error("Fetch error:",e)}finally{o(!1)}})()},[]);let v=async s=>{s.preventDefault(),b(!0),l("");try{let s=new FormData;s.append("title",p),s.append("content",m),h&&s.append("image",h);let r=await fetch("/api/stories/upload",{method:"POST",body:s}),a=await r.json();r.ok?(t([a.story,...e]),u(""),x(""),g(null),d(!1)):l(a.error||"Upload failed")}catch(e){l("Upload failed"),console.error("Upload error:",e)}finally{b(!1)}};return s?r.jsx("div",{className:"py-16 px-4 bg-white min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"Loading stories..."})]})}):r.jsx("div",{className:"py-16 px-4 bg-white",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto w-full",children:[(0,r.jsxs)("div",{className:"text-center mb-12 fade-in",children:[r.jsx("h1",{className:"section-title",children:"Stories & Testimonials"}),r.jsx("div",{className:"w-20 h-1 bg-primary mx-auto"}),r.jsx("p",{className:"section-subtitle",children:"Read inspiring stories from the communities we serve and those who support our mission."}),"authenticated"===y&&r.jsx("div",{className:"mt-8",children:r.jsx("button",{onClick:()=>d(!c),className:"btn-primary",children:c?"Cancel Upload":"Share Your Story"})})]}),c&&(0,r.jsxs)("div",{className:"bg-secondary rounded-lg p-6 mb-12 fade-in",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Share Your Story"}),n&&r.jsx("div",{className:"mb-4 alert-error",children:r.jsx("span",{className:"block sm:inline",children:n})}),(0,r.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"form-label",children:"Title"}),r.jsx("input",{type:"text",value:p,onChange:e=>u(e.target.value),className:"form-input",required:!0})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"form-label",children:"Content"}),r.jsx("textarea",{value:m,onChange:e=>x(e.target.value),rows:"6",className:"form-input",required:!0})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"form-label",children:"Image (Optional)"}),r.jsx("input",{type:"file",onChange:e=>{e.target.files&&e.target.files[0]&&g(e.target.files[0])},accept:"image/*",className:"form-input"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:j,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:j?"Submitting...":"Submit Story"})]})]})]}),n&&!c&&r.jsx("div",{className:"mb-4 alert-error",children:r.jsx("span",{className:"block sm:inline",children:n})}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:e.map(e=>(0,r.jsxs)("div",{className:"card hover:shadow-lg transition duration-300",children:[e.imageUrl&&r.jsx("img",{src:e.imageUrl,alt:e.title,className:"w-full h-48 object-cover",onError:e=>{e.target.onerror=null,e.target.src="/images/placeholder.jpg"}}),(0,r.jsxs)("div",{className:"p-6",children:[r.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-2",children:e.title}),(0,r.jsxs)("p",{className:"text-gray-600 mb-4",children:[e.content.substring(0,150),e.content.length>150?"...":""]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-700 font-medium",children:e.author}),r.jsx("p",{className:"text-gray-500 text-sm",children:new Date(e.createdAt).toLocaleDateString()})]}),r.jsx("button",{className:"text-primary font-semibold hover:text-blue-800 transition duration-300",children:"Read More â†’"})]})]})]},e._id))}),0===e.length&&!s&&r.jsx("div",{className:"text-center py-12",children:r.jsx("p",{className:"text-gray-600",children:"No stories found."})})]})})}},86315:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>o,__esModule:()=>i,default:()=>n});var r=s(68570);let a=(0,r.createProxy)(String.raw`D:\Apps\Repositories\personal\thefortress\app\stories\page.js`),{__esModule:i,$$typeof:o}=a;a.default;let n=(0,r.createProxy)(String.raw`D:\Apps\Repositories\personal\thefortress\app\stories\page.js#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,23,790,316,554],()=>s(44080));module.exports=r})();