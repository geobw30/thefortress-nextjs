(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[928],{4119:function(e,t,l){Promise.resolve().then(l.bind(l,6682))},6682:function(e,t,l){"use strict";l.r(t);var a=l(7437),s=l(2265),i=l(998);t.default=()=>{var e;let[t,l]=(0,s.useState)([]),[r,n]=(0,s.useState)(!0),[c,o]=(0,s.useState)(""),[d,m]=(0,s.useState)(!1),[x,u]=(0,s.useState)(""),[h,p]=(0,s.useState)(""),[g,f]=(0,s.useState)(null),[b,y]=(0,s.useState)(!1),{data:j,status:v}=(0,i.useSession)(),[N,w]=(0,s.useState)(!1),[k,C]=(0,s.useState)(null),[S,U]=(0,s.useState)(0);(0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/gallery"),t=await e.json();e.ok?l(t.images):o(t.error||"Failed to fetch images")}catch(e){o("Failed to fetch images"),console.error("Fetch error:",e)}finally{n(!1)}})()},[]);let E=async e=>{e.preventDefault(),y(!0),o("");try{let e=new FormData;e.append("title",x),e.append("description",h),e.append("image",g);let a=await fetch("/api/gallery/upload",{method:"POST",body:e}),s=await a.json();a.ok?(l([s.image,...t]),u(""),p(""),f(null),m(!1)):o(s.error||"Upload failed")}catch(e){o("Upload failed"),console.error("Upload error:",e)}finally{y(!1)}},_=(e,t)=>{C(e),U(t),w(!0),document.body.style.overflow="hidden"},z=()=>{w(!1),C(null),U(0),document.body.style.overflow="auto"},F=()=>{let e=0===S?t.length-1:S-1;U(e),C(t[e])},I=()=>{let e=S===t.length-1?0:S+1;U(e),C(t[e])};return((0,s.useEffect)(()=>{let e=e=>{N&&("Escape"===e.key?z():"ArrowLeft"===e.key?F():"ArrowRight"===e.key&&I())};return N&&window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[N,S,t]),r)?(0,a.jsx)("div",{className:"py-16 px-4 bg-white min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading gallery..."})]})}):(0,a.jsx)("div",{className:"py-16 px-4 bg-white",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto w-full",children:[(0,a.jsxs)("div",{className:"text-center mb-12 fade-in",children:[(0,a.jsx)("h1",{className:"section-title",children:"Our Gallery"}),(0,a.jsx)("div",{className:"w-20 h-1 bg-primary mx-auto"}),(0,a.jsx)("p",{className:"section-subtitle",children:"Explore images from our work in communities we serve."}),"authenticated"===v&&(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsx)("button",{onClick:()=>m(!d),className:"btn-primary",children:d?"Cancel Upload":"Upload Image"})})]}),d&&(0,a.jsxs)("div",{className:"bg-secondary rounded-lg p-6 mb-12 fade-in",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Upload New Image"}),c&&(0,a.jsx)("div",{className:"mb-4 alert-error",children:(0,a.jsx)("span",{className:"block sm:inline",children:c})}),(0,a.jsxs)("form",{onSubmit:E,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"Title"}),(0,a.jsx)("input",{type:"text",value:x,onChange:e=>u(e.target.value),className:"form-input w-full",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"Description"}),(0,a.jsx)("textarea",{value:h,onChange:e=>p(e.target.value),rows:"3",className:"form-input w-full"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"Image"}),(0,a.jsx)("input",{type:"file",onChange:e=>{e.target.files&&e.target.files[0]&&f(e.target.files[0])},accept:"image/*",className:"form-input w-full",required:!0})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>m(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:b,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:b?"Uploading...":"Upload"})]})]})]}),c&&!d&&(0,a.jsx)("div",{className:"mb-4 alert-error",children:(0,a.jsx)("span",{className:"block sm:inline",children:c})}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((e,t)=>{var l;return(0,a.jsxs)("div",{className:"group relative overflow-hidden rounded-lg shadow-md hover:shadow-lg transition duration-300 cursor-pointer",onClick:()=>_(e,t),children:[(0,a.jsx)("img",{src:e.imageUrl,alt:e.title,className:"w-full h-64 object-cover",onError:e=>{e.target.onerror=null,e.target.src="/images/placeholder.jpg"}}),(0,a.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-60 transition duration-300 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-white text-center opacity-0 group-hover:opacity-100 transition duration-300 p-4",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-2",children:e.title}),(0,a.jsx)("p",{className:"text-sm",children:e.description}),(0,a.jsxs)("p",{className:"text-xs mt-2 text-gray-300",children:["Uploaded by ",null===(l=e.uploadedBy)||void 0===l?void 0:l.name]})]})})]},e._id)})}),N&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:z,children:(0,a.jsxs)("div",{className:"relative max-w-6xl max-h-[90vh] w-full h-full flex items-center justify-center",onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("button",{className:"absolute top-4 right-4 text-white text-4xl z-10",onClick:z,children:"\xd7"}),(0,a.jsx)("button",{className:"absolute left-4 text-white text-5xl z-10",onClick:F,children:"‹"}),(0,a.jsx)("button",{className:"absolute right-4 text-white text-5xl z-10",onClick:I,children:"›"}),(0,a.jsx)("div",{className:"max-w-full max-h-full flex items-center justify-center",children:(0,a.jsx)("img",{src:null==k?void 0:k.imageUrl,alt:null==k?void 0:k.title,className:"max-w-full max-h-full object-contain"})}),(0,a.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-70 text-white p-4 text-center",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold",children:null==k?void 0:k.title}),(0,a.jsx)("p",{className:"text-gray-300",children:null==k?void 0:k.description}),(0,a.jsxs)("p",{className:"text-xs mt-1 text-gray-400",children:["Uploaded by ",null==k?void 0:null===(e=k.uploadedBy)||void 0===e?void 0:e.name," | Image ",S+1," of ",t.length]})]})]})}),0===t.length&&!r&&(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-gray-600",children:"No images found in the gallery."})})]})})}}},function(e){e.O(0,[998,971,23,744],function(){return e(e.s=4119)}),_N_E=e.O()}]);
//# sourceMappingURL=page-8a659030eada6152.js.map