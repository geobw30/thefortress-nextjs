(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[747],{2511:function(e,s,t){Promise.resolve().then(t.bind(t,8908))},8908:function(e,s,t){"use strict";t.r(s);var a=t(7437),r=t(2265),l=t(998);s.default=()=>{let[e,s]=(0,r.useState)([]),[t,i]=(0,r.useState)(!0),[n,c]=(0,r.useState)(""),[o,d]=(0,r.useState)(!1),[m,h]=(0,r.useState)(""),[x,u]=(0,r.useState)(""),[p,b]=(0,r.useState)(null),[j,g]=(0,r.useState)(!1),{data:f,status:N}=(0,l.useSession)();(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/stories"),t=await e.json();e.ok?s(t.stories):c(t.error||"Failed to fetch stories")}catch(e){c("Failed to fetch stories"),console.error("Fetch error:",e)}finally{i(!1)}})()},[]);let y=async t=>{t.preventDefault(),g(!0),c("");try{let t=new FormData;t.append("title",m),t.append("content",x),p&&t.append("image",p);let a=await fetch("/api/stories/upload",{method:"POST",body:t}),r=await a.json();a.ok?(s([r.story,...e]),h(""),u(""),b(null),d(!1)):c(r.error||"Upload failed")}catch(e){c("Upload failed"),console.error("Upload error:",e)}finally{g(!1)}};return t?(0,a.jsx)("div",{className:"py-16 px-4 bg-white min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading stories..."})]})}):(0,a.jsx)("div",{className:"py-16 px-4 bg-white",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto w-full",children:[(0,a.jsxs)("div",{className:"text-center mb-12 fade-in",children:[(0,a.jsx)("h1",{className:"section-title",children:"Stories & Testimonials"}),(0,a.jsx)("div",{className:"w-20 h-1 bg-primary mx-auto"}),(0,a.jsx)("p",{className:"section-subtitle",children:"Read inspiring stories from the communities we serve and those who support our mission."}),"authenticated"===N&&(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsx)("button",{onClick:()=>d(!o),className:"btn-primary",children:o?"Cancel Upload":"Share Your Story"})})]}),o&&(0,a.jsxs)("div",{className:"bg-secondary rounded-lg p-6 mb-12 fade-in",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Share Your Story"}),n&&(0,a.jsx)("div",{className:"mb-4 alert-error",children:(0,a.jsx)("span",{className:"block sm:inline",children:n})}),(0,a.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"Title"}),(0,a.jsx)("input",{type:"text",value:m,onChange:e=>h(e.target.value),className:"form-input",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"Content"}),(0,a.jsx)("textarea",{value:x,onChange:e=>u(e.target.value),rows:"6",className:"form-input",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"Image (Optional)"}),(0,a.jsx)("input",{type:"file",onChange:e=>{e.target.files&&e.target.files[0]&&b(e.target.files[0])},accept:"image/*",className:"form-input"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:j,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:j?"Submitting...":"Submit Story"})]})]})]}),n&&!o&&(0,a.jsx)("div",{className:"mb-4 alert-error",children:(0,a.jsx)("span",{className:"block sm:inline",children:n})}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:e.map(e=>(0,a.jsxs)("div",{className:"card hover:shadow-lg transition duration-300",children:[e.imageUrl&&(0,a.jsx)("img",{src:e.imageUrl,alt:e.title,className:"w-full h-48 object-cover",onError:e=>{e.target.onerror=null,e.target.src="/images/placeholder.jpg"}}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-2",children:e.title}),(0,a.jsxs)("p",{className:"text-gray-600 mb-4",children:[e.content.substring(0,150),e.content.length>150?"...":""]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-700 font-medium",children:e.author}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:new Date(e.createdAt).toLocaleDateString()})]}),(0,a.jsx)("button",{className:"text-primary font-semibold hover:text-blue-800 transition duration-300",children:"Read More â†’"})]})]})]},e._id))}),0===e.length&&!t&&(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-gray-600",children:"No stories found."})})]})})}}},function(e){e.O(0,[998,971,23,744],function(){return e(e.s=2511)}),_N_E=e.O()}]);
//# sourceMappingURL=page-941301f2c8db01db.js.map